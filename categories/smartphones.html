<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smartphones - Skylife Tecnologias</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-top">
                <div class="contact-info">
                    <a href="tel:+551199999999"><i class="fas fa-phone"></i> (11) 9999-9999</a>
                    <a href="mailto:contato@skylifetecnologias.com.br"><i class="fas fa-envelope"></i> contato@skylifetecnologias.com.br</a>
                </div>
                <div class="user-actions">
                    <a href="../admin/login.html"><i class="fas fa-user"></i> Minha Conta</a>
                    <a href="../admin/login.html"><i class="fas fa-sign-in-alt"></i> Login</a>
                    <a href="../admin/register.html"><i class="fas fa-user-plus"></i> Cadastre-se</a>
                </div>
            </div>
            <div class="header-main">
                <div class="logo">
                    <a href="../index.html">
                        <img src="../images/logo.png" alt="Skylife Tecnologias">
                    </a>
                </div>
                <div class="search-bar">
                    <form action="#" method="get">
                        <input type="text" placeholder="Digite o que está buscando...">
                        <button type="submit"><i class="fas fa-search"></i></button>
                    </form>
                </div>
                <div class="cart">
                    <a href="../cart.html">
                        <i class="fas fa-shopping-cart"></i>
                        <span>Carrinho | <span id="cartCount">0</span></span>
                    </a>
                </div>
            </div>
        </div>
        <nav>
            <div class="container">
                <div class="nav-menu">
                    <ul>
                        <li><a href="../index.html">Início</a></li>
                        <li><a href="hardware.html">Hardware</a></li>
                        <li><a href="perifericos.html">Periféricos</a></li>
                        <li><a href="notebooks.html">Notebooks</a></li>
                        <li><a href="smartphones.html" class="active">Smartphones</a></li>
                        <li><a href="../pc-builder.html">Monte seu PC</a></li>
                        <li><a href="../support.html">Suporte</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <!-- Conteúdo Principal -->
    <main class="container">
        <div class="page-header">
            <h1>Smartphones</h1>
            <p>Confira nossa seleção de smartphones e acessórios</p>
        </div>

        <!-- Filtros -->
        <div class="filters">
            <div class="filter-group">
                <label>Ordenar por:</label>
                <select id="sortOrder">
                    <option value="name-asc">Nome (A-Z)</option>
                    <option value="name-desc">Nome (Z-A)</option>
                    <option value="price-asc">Menor Preço</option>
                    <option value="price-desc">Maior Preço</option>
                </select>
            </div>
            <div class="filter-group">
                <label>Marca:</label>
                <select id="brand">
                    <option value="">Todas</option>
                    <option value="samsung">Samsung</option>
                    <option value="apple">Apple</option>
                    <option value="xiaomi">Xiaomi</option>
                    <option value="motorola">Motorola</option>
                    <option value="outros">Outros</option>
                </select>
            </div>
        </div>

        <!-- Produtos -->
        <div class="products-grid" id="products-grid">
            <div id="productsLoading" class="loading-indicator" style="text-align: center; padding: 30px; grid-column: 1 / -1;">
                <i class="fas fa-spinner fa-spin"></i> Carregando produtos...
            </div>
            <!-- Produtos serão carregados dinamicamente -->
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Institucional</h3>
                    <ul>
                        <li><a href="../about.html">Quem Somos</a></li>
                        <li><a href="../terms.html">Termos e Condições</a></li>
                        <li><a href="../privacy.html">Política de Privacidade</a></li>
                        <li><a href="../blog.html">Blog</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Atendimento</h3>
                    <ul>
                        <li><a href="../support.html">Central de Suporte</a></li>
                        <li><a href="../faq.html">Perguntas Frequentes</a></li>
                        <li><a href="../contact.html">Fale Conosco</a></li>
                        <li><a href="../returns.html">Trocas e Devoluções</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Minha Conta</h3>
                    <ul>
                        <li><a href="../admin/login.html">Meus Pedidos</a></li>
                        <li><a href="../admin/login.html">Meus Dados</a></li>
                        <li><a href="../admin/login.html">Meus Favoritos</a></li>
                        <li><a href="../admin/login.html">Rastrear Pedido</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Formas de Pagamento</h3>
                    <p>Cartões de Crédito, Boleto, Pix</p>
                    <h3>Redes Sociais</h3>
                    <div class="social-icons">
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Skylife Tecnologias - Todos os direitos reservados</p>
            </div>
        </div>
    </footer>

    <script type="module">
        import { getProductsByCategory, getAllCategories } from '../js/products.js';
        
        // Função para formatar valores monetários
        function formatCurrency(value) {
            return `R$${parseFloat(value).toFixed(2).replace('.', ',')}`;
        }
        
        // Função para criar um card de produto
        function createProductCard(product) {
            const card = document.createElement('div');
            card.className = 'product-card';
            
            const hasDiscount = product.original_price && product.original_price > product.price;
            
            card.innerHTML = `
                <div class="product-image">
                    <img src="${product.image_url || 'https://via.placeholder.com/300x300'}" alt="${product.name}">
                </div>
                <div class="product-info">
                    <h3 class="product-title">${product.name}</h3>
                    <div class="product-price">
                        ${hasDiscount ? `<span class="original-price">${formatCurrency(product.original_price)}</span>` : ''}
                        <span class="current-price">${formatCurrency(product.price)}</span>
                    </div>
                    <div class="product-actions">
                        <div class="quantity">
                            <button class="decrease-qty">-</button>
                            <input type="text" value="1" class="qty-input">
                            <button class="increase-qty">+</button>
                        </div>
                        <button class="buy-button" data-product-id="${product.id}">Comprar</button>
                    </div>
                </div>
            `;
            
            // Configurar eventos dos botões de quantidade
            const decreaseBtn = card.querySelector('.decrease-qty');
            const increaseBtn = card.querySelector('.increase-qty');
            const qtyInput = card.querySelector('.qty-input');
            
            decreaseBtn.addEventListener('click', function() {
                let qty = parseInt(qtyInput.value);
                if (qty > 1) {
                    qtyInput.value = qty - 1;
                }
            });
            
            increaseBtn.addEventListener('click', function() {
                let qty = parseInt(qtyInput.value);
                qtyInput.value = qty + 1;
            });
            
            // Configurar evento do botão de compra
            const buyButton = card.querySelector('.buy-button');
            buyButton.addEventListener('click', function() {
                const productId = this.dataset.productId;
                const quantity = parseInt(qtyInput.value);
                
                // Adicionar ao carrinho (simulação)
                addToCart(productId, quantity);
                
                alert(`Produto "${product.name}" adicionado ao carrinho!`);
            });
            
            return card;
        }
        
        // Função para adicionar ao carrinho (simulação)
        function addToCart(productId, quantity) {
            // Atualiza o contador do carrinho
            const cartCount = document.getElementById('cartCount');
            cartCount.textContent = parseInt(cartCount.textContent) + quantity;
            
            // Em um sistema real, isso seria implementado com o Supabase
            console.log(`Produto ${productId} adicionado ao carrinho, quantidade: ${quantity}`);
        }
        
        // Função para carregar produtos
        async function loadProducts() {
            try {
                // Busca todos os produtos da categoria Smartphones (ID 4)
                const result = await getProductsByCategory(4);
                
                if (result.success) {
                    displayProducts(result.products);
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                console.error('Erro ao carregar produtos:', error);
                
                // Exibe produtos de exemplo para demonstração
                displayExampleProducts();
            }
        }
        
        // Função para exibir produtos
        function displayProducts(products) {
            const container = document.getElementById('products-grid');
            const loading = document.getElementById('productsLoading');
            
            // Oculta o indicador de carregamento
            loading.style.display = 'none';
            
            if (products.length === 0) {
                container.innerHTML = '<p style="grid-column: 1 / -1; text-align: center;">Nenhum produto encontrado nesta categoria.</p>';
                return;
            }
            
            // Limpa o container
            container.innerHTML = '';
            
            // Adiciona os produtos
            products.forEach(product => {
                const card = createProductCard(product);
                container.appendChild(card);
            });
        }
        
        // Função para exibir produtos de exemplo
        function displayExampleProducts() {
            // Produtos de exemplo para smartphones
            const products = [
                { id: 25, name: 'Smartphone Samsung Galaxy S23 Ultra 256GB', price: 5999.90, image_url: 'https://via.placeholder.com/300x300?text=Galaxy+S23' },
                { id: 26, name: 'Smartphone Apple iPhone 15 Pro 128GB', price: 7999.90, image_url: 'https://via.placeholder.com/300x300?text=iPhone+15' },
                { id: 27, name: 'Smartphone Xiaomi Redmi Note 12 128GB', price: 1499.90, image_url: 'https://via.placeholder.com/300x300?text=Redmi+Note' },
                { id: 28, name: 'Smartphone Motorola Moto G84 256GB', price: 1999.90, image_url: 'https://via.placeholder.com/300x300?text=Moto+G84' },
                { id: 29, name: 'Smartphone Samsung Galaxy A54 128GB', price: 1799.90, image_url: 'https://via.placeholder.com/300x300?text=Galaxy+A54' },
                { id: 30, name: 'Smartphone Apple iPhone 14 128GB', price: 5499.90, image_url: 'https://via.placeholder.com/300x300?text=iPhone+14' },
                { id: 31, name: 'Smartphone Xiaomi POCO X5 Pro 256GB', price: 2299.90, image_url: 'https://via.placeholder.com/300x300?text=POCO+X5' },
                { id: 32, name: 'Smartphone Motorola Edge 40 256GB', price: 2799.90, image_url: 'https://via.placeholder.com/300x300?text=Edge+40' }
            ];
            
            // Exibe produtos
            displayProducts(products);
        }
        
        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            // Carrega os produtos
            loadProducts();
            
            // Configura eventos de filtro
            document.getElementById('sortOrder').addEventListener('change', function() {
                // Implementar ordenação
                loadProducts();
            });
            
            document.getElementById('brand').addEventListener('change', function() {
                // Implementar filtragem por marca
                loadProducts();
            });
        });
    </script>
</body>
</html>
